!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("PanoptoCore"),require("Hls"),require("_"),require("jQuery")):"function"==typeof define&&define.amd?define(["PanoptoCore","Hls","_","jQuery"],t):"object"==typeof exports?exports.PanoptoViewer=t(require("PanoptoCore"),require("Hls"),require("_"),require("jQuery")):e.PanoptoViewer=t(e.PanoptoCore,e.Hls,e._,e.jQuery)}(window,(function(e,t,n,r){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/dist/",n(n.s=4)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t){e.exports=n},function(e,t){e.exports=r},function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"StreamContentType",(function(){return A})),n.d(r,"ViewerPlayState",(function(){return p}));var i,o,a=n(3),s=n(0),l=function(){function e(e){this.configuration=e}return e.prototype.ajaxCall=function(e,t,n,r){var i=this;t.responseType="json",a.ajax({url:this.configuration.uriScheme+"://"+this.configuration.webServerFQDN+this.configuration.appRoot+"/Pages/Viewer/"+e,type:"POST",data:t,dataType:"json",success:n,error:r,xhrFields:{withCredentials:!0},beforeSend:function(e){return i.addCsrfHeader(e)}})},e.prototype.ajaxCallOverrideFQDN=function(e,t,n,r,i){var o=this;n.responseType="json",a.ajax({url:this.configuration.uriScheme+"://"+e+this.configuration.appRoot+"/Pages/Viewer/"+t,type:"POST",data:n,dataType:"json",success:r,error:i,xhrFields:{withCredentials:!0},beforeSend:function(e){return o.addCsrfHeader(e)}})},e.prototype.addCsrfHeader=function(e){var t=s.CookieHelpers.getCookie(this.configuration.csrfTokenCookieName);t&&e.setRequestHeader(this.configuration.csrfTokenHeaderName,t)},e.prototype.getDelivery=function(e,t,n,r,i,o){var a="DeliveryInfo.aspx";r.uniqueViewerIdParam&&r.uniqueViewerIdParam.length>0&&(a+="?uhsaWebcastViewerId="+r.uniqueViewerIdParam),r.overrideFQDN?this.ajaxCallOverrideFQDN(r.overrideFQDN,a,{deliveryId:e,tid:t,invocationId:n||"",isLiveNotes:!!r.isLiveNotes,refreshAuthCookie:!!r.refreshAuthCookie,isActiveBroadcast:!!r.isActiveBroadcast,isEditing:!!r.isEditing,isKollectiveAgentInstalled:!!r.isKollectiveAgentInstalled,isEmbed:!!r.isEmbed},(function(e){e.ErrorCode?o(e):i(e)}),o):this.ajaxCall(a,{deliveryId:e,tid:t,invocationId:n||"",isLiveNotes:!!r.isLiveNotes,refreshAuthCookie:!!r.refreshAuthCookie,isActiveBroadcast:!!r.isActiveBroadcast,isEditing:!!r.isEditing,isKollectiveAgentInstalled:!!r.isKollectiveAgentInstalled,isEmbed:!!r.isEmbed},(function(e){e.ErrorCode?o(e):i(e)}),o)},e.prototype.getCaptions=function(e,t,n,r,i){this.ajaxCall("DeliveryInfo.aspx",{deliveryId:e,tid:t,getCaptions:!0,language:n},(function(e){e.ErrorCode?i():r(e)}),i)},e.prototype.rateDelivery=function(e,t,n,r){this.ajaxCall("RateDelivery.aspx",{deliveryID:e,rating:t},(function(e){e.ErrorCode?r():n()}),r)},e.prototype.refreshAuthCookie=function(){this.ajaxCall("RefreshAuthCookie.aspx",{},a.noop,a.noop)},e.prototype.createEvent=function(e,t,n,r,i,o,a,s,l){this.ajaxCall("Notes/Note_Create.aspx",{deliveryId:e,type:t,data:n,time:r,channelName:o||void 0,deliveryRelative:!!i||void 0,createdDuringWebcast:!!a||void 0},(function(e){e.ReturnCode?s(e):l()}),l)},e.prototype.editEvent=function(e,t,n,r,i,o){this.ajaxCall("Notes/Note_Update.aspx",{sessionid:e,type:t,eventid:n,data:r},(function(e){e.ErrorMessage?o():i()}),o)},e.prototype.deleteEvent=function(e,t,n,r,i){this.ajaxCall("Notes/Note_Delete.aspx",{sessionid:e,type:t,eventid:n},(function(e){e.ErrorCode?i():r()}),i)},e.prototype.toggleEventPrivacy=function(e,t,n,r){this.ajaxCall("Notes/TogglePublic.aspx",{id:e,public:!!t||void 0},(function(e){e.Public===t?n(e):r()}),r)},e.prototype.search=function(e,t,n,r,i,o,a,s,l){this.ajaxCall("Search/Results.aspx",{id:e,type:t,query:n,notesUser:r,channelName:i,tid:o,refreshAuthCookie:a,deliveryRelative:!0},(function(e){e.Error?l():s(e.Events)}),l)},e}();!function(e){e.Play="iframePlay",e.Pause="iframePause",e.Mute="iframeMute",e.Unmute="iframeUnmute",e.Seek="iframeSeek",e.Speed="iframeSpeed",e.Volume="iframeVolume",e.Load="iframeLoad",e.Stop="iframeStop",e.CaptionsOff="iframeCaptionsOff",e.CaptionsOn="iframeCaptionsOn"}(i||(i={})),function(e){e.State="iframeState",e.Error="iframeError",e.StateUpdate="iframeStateUpdate",e.SpeedUpdate="iframeSpeedUpdate",e.IframeReady="embedIframeReady"}(o||(o={}));var d=function(){function e(e,t){var n=this;this.onCommand=e,this.hostName=t,window.addEventListener("message",(function(e){try{var t=JSON.parse(e.data);"PanoptoEmbed"===t.source&&n.onCommand(t)}catch(e){}}))}return e.prototype.sendPostMessage=function(e,t){var n={msg:e,source:"PanoptoEmbed",data:null==t?"":t};window.parent.postMessage(JSON.stringify(n),this.hostName||"*")},e}();function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t,n){var r=n.value;if("function"!=typeof r)throw new TypeError("@boundMethod decorator can only be applied to methods not: ".concat(u(r)));var i=!1;return{configurable:!0,get:function(){if(i||this===e.prototype||this.hasOwnProperty(t)||"function"!=typeof r)return r;var n=r.bind(this);return i=!0,Object.defineProperty(this,t,{configurable:!0,get:function(){return n},set:function(e){r=e,delete this[t]}}),i=!1,n},set:function(e){r=e}}}var p,h=n(1),y=function(){function e(){}return e.prototype.formatHlsjsMessage=function(e){return"[hls.js] > "+e},e.prototype.debug=function(e){arguments.length>0&&s.Logging.Logger.debug(this.formatHlsjsMessage(e))},e.prototype.log=function(e){arguments.length>0&&s.Logging.Logger.verbose(this.formatHlsjsMessage(e))},e.prototype.info=function(e){arguments.length>0&&s.Logging.Logger.info(this.formatHlsjsMessage(e))},e.prototype.warn=function(e){arguments.length>0&&s.Logging.Logger.warning(this.formatHlsjsMessage(e))},e.prototype.error=function(e){arguments.length>0&&s.Logging.Logger.error(this.formatHlsjsMessage(e))},e}(),g=function(){function e(e){this.relativeStart=e.relativeStart,this.relativeEnd=e.relativeEnd,this.segments=e.segments,this.duration=e.length}return e.prototype.updateStream=function(e){this.relativeEnd=e.relativeEnd,this.segments=e.segments},e.prototype.updateDurationFromVideoElement=function(e){this.duration=e},e.prototype.availableAt=function(e){return 0===this.segments.length?0===this.relativeEnd||e<this.relativeStart+this.duration:this.segments.some((function(t){return e>=t.relativeStart&&(t.relativeEnd===1/0||e<t.relativeEnd)}))},e}(),f=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},v=function(){function e(e,t){this.instanceId=e,this.hlsEngine=t,this.hasAudioSwapped=!1,t.on(h.Events.ERROR,this.handleError)}return e.prototype.handleError=function(e,t){var n=this;if(t.fatal){if(s.Logging.Logger.verbose(this.formatLog("Fatal "+t.type+" error caught.")),t.type===h.ErrorTypes.NETWORK_ERROR)if(navigator.onLine)s.Logging.Logger.verbose(this.formatLog("Network is online, reloading now.")),this.hlsEngine.startLoad();else{s.Logging.Logger.verbose(this.formatLog("Network is offline, reloading later."));var r=function(){s.Logging.Logger.verbose(n.formatLog("Network is back online, reloading now.")),window.removeEventListener("online",r),n.hlsEngine.startLoad()};window.addEventListener("online",r)}if(t.type===h.ErrorTypes.MEDIA_ERROR){var i=Date.now();!this.lastMediaErrorDate||i-this.lastMediaErrorDate>5e3?(s.Logging.Logger.verbose(this.formatLog("First media error, recover.")),this.lastMediaErrorDate=i,this.hlsEngine.recoverMediaError()):this.hasAudioSwapped?s.Logging.Logger.error(this.formatLog("Irrecoverable media error.")):(s.Logging.Logger.verbose(this.formatLog("Second media error, swap audio and recover.")),this.hasAudioSwapped=!0,this.hlsEngine.swapAudioCodec(),this.hlsEngine.recoverMediaError())}}},e.prototype.formatLog=function(e){return"[BaseHlsError] ["+this.instanceId+"] > "+e},f([c],e.prototype,"handleError",null),e}(),m=function(){function e(e){this.relativeStart=e.relativeStart,this.segments=e.segments,this.duration=e.length,this.liveDurationOffset=(e.broadcastSegmentDuration||9)*(e.broadcastSegmentBackoff||3),this.live=0===e.relativeEnd}return e.prototype.updateStream=function(e){this.segments=e.segments,this.live=0===e.relativeEnd},e.prototype.updateDurationFromVideoElement=function(e){this.duration=e},Object.defineProperty(e.prototype,"livePosition",{get:function(){return this.live?this.duration+this.relativeStart-this.liveDurationOffset:void 0},enumerable:!0,configurable:!0}),e.prototype.convertStreamToTimelinePosition=function(e){return this.segments.length>0?e+this.segments[0].relativeStart:e+this.relativeStart},e.prototype.convertTimelineToStreamPosition=function(e){return this.segments.length>0?e-this.segments[0].relativeStart:e-this.relativeStart},e}(),P=function(){return(P=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},S=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},b=function(){function e(e,t){if(this._buffering=!1,this.debug=-1!==window.location.search.indexOf("debug=true"),this.debugInfo=document.createElement("div"),this.debugInfo.classList.add("hls-stream-player-debug-info"),this.videoElement=document.createElement("video"),this.video.classList.add("hls-stream-player-video"),this.video.setAttribute("playsinline",""),this.container=document.createElement("div"),this.container.classList.add("hls-stream-player-container"),this.container.append(this.video),this.container.append(this.debugInfo),h.isSupported())this.hlsEngine=new h(P(P({},t),{debug:new y})),new v(e.id,this.hlsEngine);else{if(!this.video.canPlayType("application/vnd.apple.mpegurl"))throw new Error("No HLS support. Please call canLoadSource before instantiating HlsStreamPlayer.");s.Logging.Logger.warning("No MSE support but is a Safari with native HLS support.")}this.id=e.id,this.availabilityController=new g(e),this.timelineController=new m(e),this.attachEventListeners(),this.loadSource(e.url)}return e.canLoadSource=function(){return h.isSupported()||!!document.createElement("video").canPlayType("application/vnd.apple.mpegurl")},Object.defineProperty(e.prototype,"video",{get:function(){return this.videoElement},enumerable:!0,configurable:!0}),e.prototype.attachEventListeners=function(){var e=this;this.video.addEventListener("waiting",(function(){return e._buffering=!0})),this.video.addEventListener("pause",(function(){return e._buffering=!1})),this.video.addEventListener("playing",(function(){return e._buffering=!1})),this.video.addEventListener("durationchange",this.handleDurationChange);var t=function(t){return s.Logging.Logger.verbose("[BaseHls] ["+e.id+"] > "+t.type)};this.video.addEventListener("ended",t),this.video.addEventListener("error",t),this.video.addEventListener("pause",t),this.video.addEventListener("play",t),this.video.addEventListener("playing",t),this.video.addEventListener("stalled",t),this.video.addEventListener("waiting",t),this.hlsEngine&&this.hlsEngine.on(h.Events.ERROR,(function(t,n){return s.Logging.Logger.error("[BaseHls] ["+e.id+"] > ERROR!",t,n)})),this.debug&&this.updateDebugInfo()},e.prototype.loadSource=function(e){var t=this;s.Logging.Logger.info("[BaseHls] ["+this.id+"] > loading source",e);var n=new s.VoidCallback;if(this.hlsEngine)this.hlsEngine.loadSource(e),this.hlsEngine.attachMedia(this.video),this.hlsEngine.on(h.Events.MANIFEST_PARSED,(function(){n.fire()}));else{this.video.src=e;var r=function(){t.video.removeEventListener("loadedmetadata",r),n.fire()};this.video.addEventListener("loadedmetadata",r)}return n},e.prototype.updateDebugInfo=function(){var e=this;requestAnimationFrame((function(){return e.updateDebugInfo()})),this.debugInfo.innerText="\n            Position: "+this.video.currentTime.toFixed(2)+"\n            Timeline: "+this.timelinePosition.toFixed(2)+"\n            Duration: "+this.duration.toFixed(2)+"\n            Live: "+(void 0!==this.livePosition?this.livePosition.toFixed(2):void 0)+"\n            Paused: "+this.paused+"\n            Ended: "+this.ended+"\n            Buffering: "+this.buffering+"\n            Volume: "+this.volume+"\n            Muted: "+this.muted+"\n        "},e.prototype.handleDurationChange=function(){s.Logging.Logger.verbose("[BaseHls] ["+this.id+"] > duration change = "+this.video.duration),this.availabilityController.updateDurationFromVideoElement(this.video.duration),this.timelineController.updateDurationFromVideoElement(this.video.duration)},e.prototype.updateStream=function(e){this.availabilityController.updateStream(e),this.timelineController.updateStream(e)},e.prototype.attachToDOM=function(e){e.prepend(this.container)},e.prototype.detachFromDOM=function(){this.container.parentNode&&this.container.parentNode.removeChild(this.container)},Object.defineProperty(e.prototype,"muted",{get:function(){return this.video.muted},set:function(e){s.Logging.Logger.verbose("[BaseHls] ["+this.id+"] > muted",e),this.video.muted=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"volume",{get:function(){return this.video.volume},set:function(e){s.Logging.Logger.verbose("[BaseHls] ["+this.id+"] > volume",e),this.video.volume=e},enumerable:!0,configurable:!0}),e.prototype.pause=function(){s.Logging.Logger.verbose("[BaseHls] ["+this.id+"] > pause()"),this.video.pause()},e.prototype.play=function(){return s.Logging.Logger.verbose("[BaseHls] ["+this.id+"] > play()"),this.video.play()},e.prototype.availableAt=function(e){return this.availabilityController.availableAt(e)},Object.defineProperty(e.prototype,"position",{get:function(){return this.video.currentTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"livePosition",{get:function(){return this.timelineController.livePosition},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timelinePosition",{get:function(){return this.timelineController.convertStreamToTimelinePosition(this.video.currentTime)},set:function(e){s.Logging.Logger.verbose("[BaseHls] ["+this.id+"] > timelinePosition = "+e),this.video.currentTime=this.timelineController.convertTimelineToStreamPosition(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this.video.duration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paused",{get:function(){return this.video.paused},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ended",{get:function(){return this.video.ended},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buffering",{get:function(){return this._buffering},enumerable:!0,configurable:!0}),S([c],e.prototype,"handleDurationChange",null),e}();!function(e){e[e.Playing=1]="Playing",e[e.Paused=2]="Paused",e[e.Stopped=3]="Stopped",e[e.Buffering=4]="Buffering"}(p||(p={}));var C,E=function(){function e(e){this.state=e}return e.prototype.addHlsStreamPlayer=function(e){var t=this;e.video.addEventListener("seeked",(function(n){return t.handlePositionChange(n,e)})),e.video.addEventListener("timeupdate",(function(n){return t.handlePositionChange(n,e)})),e.video.addEventListener("ended",(function(n){return t.handlePlayStateChange(n,e)})),e.video.addEventListener("error",(function(n){return t.handlePlayStateChange(n,e)})),e.video.addEventListener("pause",(function(n){return t.handlePlayStateChange(n,e)})),e.video.addEventListener("playing",(function(n){return t.handlePlayStateChange(n,e)})),e.video.addEventListener("stalled",(function(n){return t.handlePlayStateChange(n,e)})),e.video.addEventListener("waiting",(function(n){return t.handlePlayStateChange(n,e)}))},e.prototype.updateState=function(e){this.state=e},e.prototype.handlePositionChange=function(e,t){t===this.state.activePrimary&&"seeked"===e.type&&this.loggerSeekHandler&&this.loggerSeekHandler()},e.prototype.handlePlayStateChange=function(e,t){if(t===this.state.activePrimary)if("pause"===e.type){var n=t.position>=t.duration-.1?p.Stopped:p.Paused;this.loggerPlayStateChangeHandler&&this.loggerPlayStateChangeHandler(p.Playing,n)}else"play"===e.type?t.position<t.duration&&this.loggerPlayStateChangeHandler&&this.loggerPlayStateChangeHandler(p.Paused,p.Playing):"ended"===e.type&&this.loggerPlayStateChangeHandler&&this.loggerPlayStateChangeHandler(void 0,p.Stopped)},e.prototype.createPlayerInterfaceForPlaybackLogger=function(){var e=this;return{playSpeed:function(){return e.state.playbackRate},streamId:function(){return e.state.activePrimary&&e.state.activePrimary.id},position:function(){return e.state.activePrimary&&e.state.activePrimary.position||0},onSeek:function(t){e.loggerSeekHandler=t},onPlayStateChangeLog:function(t){e.loggerPlayStateChangeHandler=t},onSpeedChange:function(t){e.loggerSpeedChangeHandler=t}}},e}(),L=n(2),w=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r},O=function(){function e(e){this.onPlayerCreated=e,this.players={},this.delivery={primaryStreams:[],secondaryStreams:[]}}return e.prototype.updateDelivery=function(e){var t=this;w(e.primaryStreams,e.secondaryStreams).forEach((function(e){if(t.players[e.id])t.players[e.id].updateStream(e);else{var n=new b(e);t.onPlayerCreated(n),t.players[e.id]=n}})),this.delivery=e},e.prototype.getActivePlayers=function(e){var t=this,n=this.delivery.primaryStreams[this.delivery.primaryStreams.length-1];return{primary:L.chain(this.delivery.primaryStreams).map((function(e){return t.players[e.id]})).filter((function(t){return t.availableAt(e)})).first().value()||this.players[n.id],secondary:L.chain(this.delivery.secondaryStreams).map((function(e){return t.players[e.id]})).filter((function(t){return t.availableAt(e)})).last().value()}},e}(),j=function(){function e(e){this.options=e}return e.prototype.addHlsStreamPlayer=function(e){var t=this;e.video.addEventListener("seeked",(function(n){return t.handlePositionChange(n,e)})),e.video.addEventListener("timeupdate",(function(n){return t.handlePositionChange(n,e)})),e.video.addEventListener("ended",(function(n){return t.handlePlayStateChange(n,e)})),e.video.addEventListener("error",(function(n){return t.handlePlayStateChange(n,e)})),e.video.addEventListener("pause",(function(n){return t.handlePlayStateChange(n,e)})),e.video.addEventListener("playing",(function(n){return t.handlePlayStateChange(n,e)})),e.video.addEventListener("stalled",(function(n){return t.handlePlayStateChange(n,e)})),e.video.addEventListener("waiting",(function(n){return t.handlePlayStateChange(n,e)}))},e.prototype.updateState=function(e){var t=e.activePrimary,n=e.activeSecondary,r=e.timelinePosition,i=e.volume,o=e.muted,a=e.paused;t&&(this.setActivePlayers(t,n),t.volume!==i&&(t.volume=i),t.muted!==o&&(t.muted=o)),n&&!n.muted&&(n.muted=!0),void 0!==r&&this.syncPosition(r),this.syncPlayState(a)},e.prototype.setActivePlayers=function(e,t){this.activePrimaryPlayer!==e&&(this.activePrimaryPlayer&&this.activePrimaryPlayer.pause(),this.activePrimaryPlayer=e),this.activeSecondaryPlayer!==t&&(this.activeSecondaryPlayer&&this.activeSecondaryPlayer.pause(),this.activeSecondaryPlayer=t,t&&this.handlePlayStateChange(new Event("activesecondarychange"),t))},e.prototype.handlePositionChange=function(e,t){t===this.activePrimaryPlayer&&this.options.onTimelinePositionChanged(t.timelinePosition)},e.prototype.syncPosition=function(e){if(this.activeSecondaryPlayer&&!this.activeSecondaryPlayer.buffering){var t=this.activeSecondaryPlayer.timelinePosition-e;Math.abs(t)>1&&(s.Logging.Logger.verbose("[SyncController] > diff is outside threshold, sync position triggered",t,e),this.activeSecondaryPlayer.timelinePosition=e)}},e.prototype.handlePlayStateChange=function(e,t){if(t===this.activePrimaryPlayer){s.Logging.Logger.verbose("[SyncController] > primary play state changed",t.paused,t.buffering);var n=t.paused||t.buffering;this.options.onPlayStateChanged(n),this.syncPlayState(n)}else if(this.activePrimaryPlayer&&t===this.activeSecondaryPlayer){n=this.activePrimaryPlayer.paused||this.activePrimaryPlayer.buffering;this.syncPlayState(n)}else t.paused||t.buffering||t.pause()},e.prototype.syncPlayState=function(e){if(this.activeSecondaryPlayer&&!this.activeSecondaryPlayer.buffering&&e!==this.activeSecondaryPlayer.paused)if(e)s.Logging.Logger.verbose("[SyncController] > sync to pause"),this.activeSecondaryPlayer.pause();else{if(this.activeSecondaryPlayer.ended)return;s.Logging.Logger.verbose("[SyncController] > sync to resume"),this.activeSecondaryPlayer.play()}},e}(),T=function(){return(T=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},D=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};!function(e){e[e.Normal=0]="Normal",e[e.Swapped=1]="Swapped",e[e.PrimaryOnly=2]="PrimaryOnly",e[e.SecondaryOnly=3]="SecondaryOnly"}(C||(C={}));var H,k,x=function(){function e(e,t){this.onStateChanged=t,this.state={playbackRate:1,paused:!0,volume:1,muted:!1,playerLayoutMode:C.Normal},this.playersController=new O(this.handlePlayerCreated),this.layoutController=new M,this.playbackLoggerController=new E(this.state),this.synchronizationController=new j({onTimelinePositionChanged:this.handleTimelinePositionChanged,onPlayStateChanged:this.handlePlayStateChanged}),this.playersController.updateDelivery(e)}return Object.defineProperty(e.prototype,"currentState",{get:function(){return this.state},enumerable:!0,configurable:!0}),e.prototype.createPlayerInterfaceForPlaybackLogger=function(){return this.playbackLoggerController.createPlayerInterfaceForPlaybackLogger()},e.prototype.updateDelivery=function(e){this.playersController.updateDelivery(e);var t=this.state,n=t.timelinePosition,r=t.activePrimary;n&&r&&r.ended&&(r!==this.playersController.getActivePlayers(1/0).primary&&this.start(1/0))},e.prototype.start=function(e){s.Logging.Logger.debug("[TimelineController] > start",e);var t=this.playersController.getActivePlayers(e).primary;e===1/0&&(e=t.livePosition||t.timelinePosition,s.Logging.Logger.debug("[TimelineController] > start",e)),this.handleTimelinePositionChanged(e),t&&(t.timelinePosition=e,t.play())},e.prototype.resume=function(){this.currentState.activePrimary&&this.currentState.activePrimary.play()},e.prototype.pause=function(){this.currentState.activePrimary&&this.currentState.activePrimary.pause()},e.prototype.muted=function(e){this.state=T(T({},this.state),{muted:e}),this.notifyStateChange()},e.prototype.volume=function(e){this.state=T(T({},this.state),{volume:e}),this.notifyStateChange()},e.prototype.cyclePlayerLayoutMode=function(){var e=this.state.playerLayoutMode!==C.SecondaryOnly?this.state.playerLayoutMode+1:C.Normal;this.state=T(T({},this.state),{playerLayoutMode:e}),this.notifyStateChange()},e.prototype.seek=function(e){"number"==typeof e&&this.handleTimelinePositionChanged(e)},e.prototype.notifyStateChange=function(){this.layoutController.updateState(this.state),this.playbackLoggerController.updateState(this.state),this.synchronizationController.updateState(this.state),this.onStateChanged(this.state)},e.prototype.handlePlayerCreated=function(e){this.playbackLoggerController.addHlsStreamPlayer(e),this.synchronizationController.addHlsStreamPlayer(e)},e.prototype.handleTimelinePositionChanged=function(e){var t=this.playersController.getActivePlayers(e),n=t.primary,r=t.secondary;this.state=T(T({},this.state),{timelinePosition:e,activePrimary:n,activeSecondary:r}),this.notifyStateChange()},e.prototype.handlePlayStateChanged=function(e){this.state=T(T({},this.state),{paused:e}),this.notifyStateChange()},D([c],e.prototype,"handlePlayerCreated",null),D([c],e.prototype,"handleTimelinePositionChanged",null),D([c],e.prototype,"handlePlayStateChanged",null),e}(),M=function(){function e(){var e=document.getElementById("player"),t=document.getElementById("pipPlayer");if(null===e||null===t)throw Error("#player and/or #pipPlayer not found in DOM.");this.playerElement=e,this.pipPlayerElement=t}return e.prototype.updateState=function(e){var t,n,r=e.activePrimary,i=e.activeSecondary;switch(i?(t=i,n=r):(t=r,n=void 0),e.playerLayoutMode){case C.Normal:this.pipPlayerElement.style.display="block";break;case C.Swapped:if(n){var o=n;n=t,t=o}this.pipPlayerElement.style.display="block";break;case C.PrimaryOnly:t=r,n=void 0,this.pipPlayerElement.style.display="none";break;case C.SecondaryOnly:t=i,n=r,this.pipPlayerElement.style.display="none"}this.currentPlayer!==t&&(s.Logging.Logger.debug("[LayoutController] > player changed",t&&t.id),this.currentPlayer&&this.currentPlayer.detachFromDOM(),t&&t.attachToDOM(this.playerElement),this.currentPlayer=t,this.currentPipPlayer===this.currentPlayer&&(this.currentPipPlayer=void 0)),this.currentPipPlayer!==n&&(s.Logging.Logger.debug("[LayoutController] > pipPlayer changed",n&&n.id),this.currentPipPlayer&&this.currentPipPlayer.detachFromDOM(),n&&n.attachToDOM(this.pipPlayerElement),this.currentPipPlayer=n)},e}();!function(e){e.None="",e.Slide="ppt",e.Transcript="transcript",e.Note="notes",e.Bookmark="bookmarks",e.Comment="comments"}(H||(H={})),function(e){e[e.Slowest=.5]="Slowest",e[e.Slow=.75]="Slow",e[e.Normal=1]="Normal",e[e.Fast=1.25]="Fast",e[e.Faster=1.5]="Faster",e[e.FasterYet=1.75]="FasterYet",e[e.Fastest=2]="Fastest"}(k||(k={}));var A,N=function(){function e(e,t){this.brandElement=e?this.renderImgOnly(t):this.render(t)}return e.prototype.render=function(t){var n=$(e.template());return $(n).find(".logo-while-playing").attr("src",t),n},e.prototype.renderImgOnly=function(t){return $(e.templateImgOnly({logo:t}))},e.prototype.setHeight=function(e){$(this.brandElement).find(".logo-box").height(e)},e.prototype.getBrandElem=function(){return this.brandElement},e.template=L.template('\n        <div class="logo-container-while-playing">\n            <img class="logo-while-playing" />\n            <div class="logo-box"></div>\n        </div>'),e.templateImgOnly=L.template('\n        <img class="logo-container-while-playing logo-while-playing"\n            src="<@= logo @>" \n            />'),e}();!function(e){e[e.Audio=0]="Audio",e[e.Screen=1]="Screen",e[e.Slide=2]="Slide",e[e.Camera=3]="Camera"}(A||(A={})),n.d(t,"DeliveryService",(function(){return l})),n.d(t,"EmbedApiMessagesToFrame",(function(){return i})),n.d(t,"EmbedApiMessagesToParent",(function(){return o})),n.d(t,"EmbedApiParser",(function(){return d})),n.d(t,"HlsStreamPlayer",(function(){return b})),n.d(t,"HlsStreamPlayerAvailabilityController",(function(){return g})),n.d(t,"HlsStreamPlayerErrorController",(function(){return v})),n.d(t,"HlsStreamPlayerTimelineController",(function(){return m})),n.d(t,"HlsjsDebugLogger",(function(){return y})),n.d(t,"LayoutController",(function(){return M})),n.d(t,"EventType",(function(){return H})),n.d(t,"PlaySpeed",(function(){return k})),n.d(t,"PlaybackLoggerController",(function(){return E})),n.d(t,"PlayersController",(function(){return O})),n.d(t,"SynchronizationController",(function(){return j})),n.d(t,"PlayerLayoutMode",(function(){return C})),n.d(t,"TimelineController",(function(){return x})),n.d(t,"WatermarkLogo",(function(){return N})),n.d(t,"Data",(function(){return r}))}])}));
//# sourceMappingURL=file://seasyn/tfsbuilds/panopto_core_rel-rtc-9.6.1_x64/20200911.30/_PublishedWebsites/WebUI/Scripts/Panopto/Bundles/viewer.umd.js.map